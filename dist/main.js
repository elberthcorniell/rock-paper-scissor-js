(()=>{"use strict";let t,e={};const o=t=>{const{value:o,id:n}=t.target;e[n]=o},n=(t,e="",o="")=>{if(void 0===t)return!1;const n=document.createElement(t);return n.className=e,n.innerHTML=o,n},i=({callToAction:t,id:e,modalBody:o})=>{const i=n("button","btn btn-success",t);i.type="button";const r=document.createAttribute("data-toggle");r.value="modal",i.setAttributeNode(r);const d=document.createAttribute("data-target");d.value=`#${e}Modal`,i.setAttributeNode(d),o=n("div","modal-body",o);const a=n("div","modal-header",`\n  <h5 class='modal-title' id='exampleModalLabel'>${t}</h5>\n  <button type='button' class='close' data-dismiss='modal' aria-label='Close'>\n  <span aria-hidden='true'>&times;</span>\n  </button>\n  `),s=n("div","modal-content"),l=n("div","modal-dialog"),c=document.createAttribute("role");c.value="document",l.setAttributeNode(c),s.appendChild(a),s.appendChild(o),l.appendChild(s);const u=n("div","modal fade",l.outerHTML);u.id=`${e}Modal`;const p=document.createAttribute("tabindex");p.value="-1",u.setAttributeNode(p);const g=document.createAttribute("role");g.value="dialog",u.setAttributeNode(g);const m=document.createAttribute("aria-labelledby");m.value="exampleModalLabel",u.setAttributeNode(m);const h=document.createAttribute("aria-hidden");return h.value="true",u.setAttributeNode(h),document.getElementById("content").appendChild(u),i},r=e=>{t=e},d=()=>e,a=()=>{const e=s("group");return o({target:{value:e,id:"group"}}),t||(e?2:1)},s=t=>new URL(window.location.href).searchParams.get(t),l=()=>JSON.parse(localStorage.getItem("groups")||"[]"),c=()=>JSON.parse(localStorage.getItem("tasks")||"{}");class u{constructor({title:t,description:e}){this.title=String(t),this.description=String(e)}save(){const t=l();t.push(this.getAsObject()),localStorage.setItem("groups",JSON.stringify(t))}getAsObject(){const{title:t,description:e}=this;return{title:t,description:e}}}class p{constructor({title:t,description:e,dueDate:o,priority:n,group:i=s("group")}){this.title=String(t),this.description=String(e),this.dueDate=new Date(o),this.priority=Number(n),this.group=i}save(){const t=c();t[this.group]=t[this.group]||[],t[this.group].push(this.getAsObject()),localStorage.setItem("tasks",JSON.stringify(t))}delete(){const t=c();for(const e in t[this.group]){const o=t[this.group][e];o&&o.title==this.title&&delete t[this.group][e]}t[this.group]=t[this.group].filter((t=>null!=t)),localStorage.setItem("tasks",JSON.stringify(t))}getAsObject(){const{title:t,description:e,dueDate:o,priority:n,group:i}=this;return{title:t,description:e,dueDate:o,priority:n,group:i}}}const g=["Groups","Tasks"],m=()=>{const t=n("div","home"),e=document.createElement("form");["Title","Description","submit"].map((t=>{const o=n("input",void 0,t);return o.type=t,o.placeholder=t,o.id=`${t}GroupField`,e.appendChild(o),!0})),e.id="newGroupForm";const o=i({callToAction:"New Group",id:"newGroup",modalBody:e.outerHTML}),r=n("div","row");l().map((t=>{const e=n("div","card-body");e.innerHTML=`\n      <strong>${t.title}</strong>\n      <p>${t.description||""}</p>\n      <a href='?group=${t.title}'><strong>View group</strong></a>`;const o=n("div","card",e.outerHTML),i=n("div","col-3",o.outerHTML);return r.appendChild(i),!0})),t.appendChild(o),t.appendChild(r),document.getElementById("content").appendChild(t)},h=()=>{switch(document.getElementById("content").innerHTML="",(()=>{const t=n("nav","nav");t.appendChild(n("strong","nav-link active","Deadline")),g.map((e=>{const o=n("a","nav-link active",e);return o.href="#",o.id=e.toLowerCase(),t.appendChild(o),!0})),document.getElementById("content").appendChild(t)})(),a()){case 1:m();break;case 2:(()=>{const t=n("div","home"),e=document.createElement("form");["Title","Description","date","priority","submit"].map((t=>{const o=n("input",void 0,t);return o.type=t,o.placeholder=t,o.id=`${t}TaskField`,e.appendChild(o),!0})),e.id="newTaskForm";const o=i({callToAction:"New Task",id:"newTask",modalBody:e.outerHTML}),r=n("div","row"),a=c()[d().group];if(a)for(const t in a){const e=a[t];if(!e)continue;const o=new p(e),d=JSON.stringify(o.getAsObject()),c=n("div","card-body");c.innerHTML=`\n      <strong>${e.title}</strong>\n      <p>${e.description||""}</p>\n      <strong>Due date: ${l=e.dueDate,`${(l=new Date(l)).getDate()} ${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][l.getMonth()]}, ${l.getFullYear()}`||""}</strong><br>\n      <strong>Priority: ${e.priority||""}</strong><br>\n      <a class='btn btn-danger' href='?delete=${s=d,window.btoa(unescape(encodeURIComponent(s)))}&group=${o.group}' >delete</a>`,c.appendChild(i({callToAction:"View Task",id:`task${e.title}${t}`,modalBody:c.innerHTML}));const u=n("div","card",c.outerHTML),g=n("div","col-3",u.outerHTML);r.appendChild(g)}var s,l;t.appendChild(o),t.appendChild(r),document.getElementById("content").appendChild(t)})();break;default:m()}},b=()=>{h(),document.getElementById("groups").addEventListener("click",(()=>{r(1),h()})),document.getElementById("tasks").addEventListener("click",(()=>{r(2),h()}))};switch(b(),a()){case 1:default:const t=document.getElementById("newGroupForm"),{childNodes:e}=t;for(const t in e)"input"==e[t].localName&&e[t].addEventListener("input",o);t.addEventListener("submit",(t=>{t.preventDefault();const{TitleGroupField:e,DescriptionGroupField:o}=d();new u({title:e,description:o}).save(),window.location.reload()}));break;case 2:const n=document.getElementById("newTaskForm"),{childNodes:i}=n;for(const t in i)"input"==i[t].localName&&i[t].addEventListener("input",o);n.addEventListener("submit",(t=>{t.preventDefault();const{TitleTaskField:e,DescriptionTaskField:o,dateTaskField:n,priorityTaskField:i}=d();new p({title:e,description:o,dueDate:n,priority:i}).save(),window.location.reload()}))}if(null===localStorage.getItem("groups")&&(localStorage.setItem("groups",JSON.stringify([{title:"default",description:"For general tasks"}])),b()),s("delete")){const t=JSON.parse((v=s("delete"),decodeURIComponent(escape(window.atob(v)))));new p(t).delete(),b()}var v})();